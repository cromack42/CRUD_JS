<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SISTEMA CRUD</title>
    <style>
        input[type= 'submit'], button, [aria-label]{
            cursor: pointer;
        }
        #spoiler{
            display:none;
        }
    </style>
</head>
<body>
    <h1>Lista de países na copa</h1>

    <form action="javascript:void(0);" method="POST"onsubmit="app.Add()">
        <input type="text" id="add-name" placeholder="Novo País">
        <input type="submit" value="Adcionar">     
     </form>
     <div id="spoiler" role="aria-hidden">
        <form action="javascript:void(0);" method="POST" id="saveEdit">
        <input type="text" id="edit-name">
        <input type="submit" value="Editar"> <a onclick="CloseInput()" aria-label="Close">&#10006></a>
        </form>
     </div>
     <p id="counter"></p>
     <table>
        <tr>
            <th>NOME DO PÁIS</th>
        </tr>
        <tbody id="countries">
        </tbody>
     </table>

     <!--Desenvolvendo as nossas funções para o CRUD funcionar-->
     <script>
        var app = new function() {

            this.el = document.getElementById('countries');

            this.countries = ['Brasil', 'Alemanha', 'Inglaterra', 'Espanha', 'Itália', 'Mexico', 'Portugal', 'Chile'];

            this.count = function(data){
                var el = document.getElementById('counter');
                var name = 'países';

                if (data){
                    if (data > 1){
                        name = 'países';
                    }
                    el.innerHTML = data + ' ' + name ;
                }else{
                    el.innerHTML = 'Nenhum' + name;
                }
            };
            
            // monta a lista com as variáveis setadas
            this.FetchAll = function(){
                var data = '';

                if(this.countries.length > 0){
                    //laço de repetição para correr os registros no array
                    for (i = 0; i < this.countries.length; i++){
                        data += '<tr>';
                            data += '<td>' + this.countries[i] + '</td>';
                            data += '<td><button onClick = "app.Edit('+ i +')">Edit</button></td>';
                            data += '<td><button onclick = "app.Edit('+ i + ')">Delete</button></td>';
                            data += '</tr>'
                        }
                    }
                    this.count(this.countries.length);
                    return this.el.innerHTML = data;
                };
                this.Add = function(){
                    el = document.getElementById('add-name');
                    var country = el.value;

                    if(country){
                    this.countries.push(countries.trim());
                    el.value = '';
                    this.FetchAll()
                } };

                this.Edit = function(item){
                    var el = document.getElementById('edit-name');
                    el.value = this.countries[item]
                    document.getElementById('spoiler').style.display= 'block';
                    self = this;
                    document.getElementById('saveEdit').onsubmit = function(){
                        var country = el.value
                        if(country){
                            self.countries.splice(item, 1, country.trim());
                            self.FetchAll();
                            CloseInput();

                        }
                    }
                };
                this.Delete = function(item){
                    this.countries.splice(item, 1);
                    this.FetchAll();
                }

                app.FetchAll();

                function CloseInput(){
                    document.getElementById('spoiler').style.display= 'none';
                }
            }
     </script>
</body>
</html>